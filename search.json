[{"path":"https://hsbadr.github.io/HiClimR/articles/BugReports.html","id":"description","dir":"Articles","previous_headings":"","what":"Description","title":"Bug Reporting","text":"Provide clear concise description problem including warning error messages.","code":""},{"path":"https://hsbadr.github.io/HiClimR/articles/BugReports.html","id":"reproduction","dir":"Articles","previous_headings":"","what":"Reproduction","title":"Bug Reporting","text":"Provide clean R script demonstrating issue necessary data files. Please include minimal reproducible example (AKA reprex). ’ve never heard reprex , start reading https://www.tidyverse.org/help/#reprex.","code":""},{"path":"https://hsbadr.github.io/HiClimR/articles/BugReports.html","id":"environment","dir":"Articles","previous_headings":"","what":"Environment","title":"Bug Reporting","text":"Provide following information: OS Type: [e.g., Linux, macOS, Windows] OS Version: [e.g., macOS 11.3, Windows 10, Ubuntu 20.04] R Version: [e.g., 4.0, 4.1, 4.2] Version: [e.g., 0.0.3 development] Source: [e.g., binary source code] Repository: [e.g., CRAN, Bioconductor, GitHub, ]","code":""},{"path":"https://hsbadr.github.io/HiClimR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hamada S. Badr. Author, maintainer. Benjamin F. Zaitchik. Author. Amin K. Dezfuli. Author.","code":""},{"path":"https://hsbadr.github.io/HiClimR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015): Tool Hierarchical Climate Regionalization, _Earth Science Informatics_, **8**(4), 949-958, https://doi.org/10.1007/s12145-015-0221-7. Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014): HiClimR: Hierarchical Climate Regionalization, _Comprehensive R Archive Network (CRAN)_, https://cran.r-project.org/package=HiClimR.","code":"@Article{HiClimR-paper,   title = {A Tool for Hierarchical Climate Regionalization},   author = {Hamada S. Badr and Benjamin F. Zaitchik and Amin K. Dezfuli},   year = {2015},   journal = {Earth Science Informatics},   publisher = {Springer},   volume = {8},   number = {4},   pages = {949--958},   doi = {10.1007/s12145-015-0221-7},   url = {https://doi.org/10.1007/s12145-015-0221-7},   language = {English}, } @Manual{HiClimR-package,   title = {HiClimR: Hierarchical Climate Regionalization},   author = {Hamada S. Badr and Benjamin F. Zaitchik and Amin K. Dezfuli},   year = {2014},   journal = {Comprehensive R Archive Network (CRAN)},   url = {https://cran.r-project.org/package=HiClimR},   language = {English}, }"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"hiclimr","dir":"","previous_headings":"","what":"Hierarchical Climate Regionalization","title":"Hierarchical Climate Regionalization","text":"HiClimR: Hierarchical Climate Regionalization","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"table-of-contents","dir":"","previous_headings":"","what":"Table of Contents","title":"Hierarchical Climate Regionalization","text":"Introduction Features Implementation CRAN GitHub Source License Citation History Single-Variate Clustering Multivariate Clustering Miscellaneous Examples","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Hierarchical Climate Regionalization","text":"HiClimR tool Hierarchical Climate Regionalization applicable correlation-based clustering. Climate regionalization process dividing area smaller regions homogeneous respect specified climatic metric. Several features added facilitate applications climate regionalization (spatiotemporal analysis general) implement cluster validation function objective tree cutting find optimal number clusters user-specified confidence level. include options preprocessing postprocessing well efficient code execution large datasets options splitting big data computing upper-triangular half correlation/dissimilarity matrix overcome memory limitations. Hybrid hierarchical clustering reconstructs upper part tree cut get best available methods. Multivariate clustering (MVC) provides options filtering variables preprocessing, detrending standardization variable, applying weights preprocessed variables. ⇪","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Hierarchical Climate Regionalization","text":"HiClimR adds several features new clustering method (called, regional linkage) hierarchical clustering R (hclust function stats library) including: data regridding coarsening spatial resolution continents regions countries contiguity-constrained clustering mean threshold variance threshold detrending standardization PCA splitting big data matrix computing upper-triangular matrix ATLAS OpenBLAS Intel MKL regional linkage minimum inter-regional correlation ward’s minimum variance error sum squares method single linkage nearest neighbor method complete linkage diameter average linkage, group average, UPGMA method mcquitty’s WPGMA method median, Gower’s WPGMC method centroid UPGMC method upper part tree reconstructed cut lower part tree uses user-selected method upper part tree uses regional linkage method filtering variables preprocessing detrending standardization variable applying weight preprocessed variables summary statistics based raw data data reconstructed PCA objective tree cut using minimum significant correlation region means visualization regionalization results exporting region map mean timeseries NetCDF-4 regional linkage method explained context spatiotemporal problem, N spatial elements (e.g., weather stations) divided k regions, given element time series length M. based inter-regional correlation distance temporal means different regions (elements first merging step). modifies update formulae average linkage method incorporating standard deviation merged region timeseries, function correlation individual regions, standard deviations merging. equal average standard deviations correlation two merged regions 100%. special case, regional linkage method reduced classic average linkage clustering method. ⇪","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"implementation","dir":"","previous_headings":"","what":"Implementation","title":"Hierarchical Climate Regionalization","text":"Badr et al. (2015) describes regionalization algorithms, features, data processing tools included package presents demonstration application package used regionalize Africa basis interannual precipitation variability. figure shows detailed flowchart package. Cyan blocks represent helper functions, green input data parameters, yellow indicates agglomeration Fortran code, purple shows graphics options. multivariate clustering (MVC), input data list matrices (one matrix variable number rows clustered; number columns may vary per variable). blue dashed boxes involve loop variables apply mean /variance thresholds, detrending, /standardization per variable weighing preprocessed variables binding columns one matrix clustering. x input N x M data matrix, xc coarsened N0 x M data matrix N0 ≤ N (N0 = N lonStep = 1 latStep = 1), xm masked filtered N1 x M1 data matrix N1 ≤ N0 (N1 = N0 number masked stations/points zero) M1 ≤ M (M1 = M columns removed due missing values), x1 reconstructed N1 x M1 data matrix PCA performed.  HiClimR applicable correlation-based clustering. ⇪","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical Climate Regionalization","text":"many ways install R package precompiled binaries source code. details, may search install R package, convenient ways install HiClimR:","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"from-cran","dir":"","previous_headings":"Installation","what":"From CRAN","title":"Hierarchical Climate Regionalization","text":"easiest way install R package Windows, Mac, Linux. just fire R shell type: theory package just install, however, may asked select local mirror (.e. server use download package). using R-GUI R-Studio, can find menu package installation can just search HiClimR install . ⇪","code":"install.packages(\"HiClimR\")"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"from-github","dir":"","previous_headings":"Installation","what":"From GitHub","title":"Hierarchical Climate Regionalization","text":"intended developers requires development environment (compilers, libraries, … etc) install latest development release HiClimR. Linux Mac, can download source code use R CMD INSTALL install . convenient way, may use pak follows: Install pak CRAN: Make sure working development environment: Windows: Install Rtools. Mac: Install Xcode Mac App Store. Linux: Install compiler various development libraries (details vary across different flavors Linux). Install HiClimR GitHub source: ⇪","code":"install.packages(\"pak\") pak::pkg_install(\"hsbadr/HiClimR\")"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"source","dir":"","previous_headings":"","what":"Source","title":"Hierarchical Climate Regionalization","text":"source code repository can found GitHub hsbadr/HiClimR. ⇪","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Hierarchical Climate Regionalization","text":"HiClimR licensed GPL v3. code modified Hamada S. Badr src/library/stats/R/hclust.R part R package Copyright © 1995-2021 R Core Team. program free software; can redistribute /modify terms GNU General Public License published Free Software Foundation; either version 2 License, (option) later version. program distributed hope useful, WITHOUT WARRANTY; without even implied warranty MERCHANTABILITY FITNESS PARTICULAR PURPOSE. See GNU General Public License details. copy GNU General Public License available https://www.r-project.org/Licenses. Copyright © 2013-2021 Earth Planetary Sciences (EPS), Johns Hopkins University (JHU). ⇪","code":""},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Hierarchical Climate Regionalization","text":"cite HiClimR publications, please use: Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015): Tool Hierarchical Climate Regionalization, Earth Science Informatics, 8(4), 949-958, https://doi.org/10.1007/s12145-015-0221-7. Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014): HiClimR: Hierarchical Climate Regionalization, Comprehensive R Archive Network (CRAN), https://cran.r-project.org/package=HiClimR. ⇪","code":"citation(\"HiClimR\")"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"history","dir":"","previous_headings":"","what":"History","title":"Hierarchical Climate Regionalization","text":"⇪","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"single-variate-clustering","dir":"","previous_headings":"Examples","what":"Single-Variate Clustering","title":"Hierarchical Climate Regionalization","text":"⇪","code":"library(HiClimR) #----------------------------------------------------------------------------------# # Typical use of HiClimR for single-variate clustering:                            # #----------------------------------------------------------------------------------#  ## Load the test data included/loaded in the package (1 degree resolution) x <- TestCase$x lon <- TestCase$lon lat <- TestCase$lat  ## Generate/check longitude and latitude mesh vectors for gridded data xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Single-Variate Hierarchical Climate Regionalization y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) #----------------------------------------------------------------------------------# # Additional Examples:                                                             # #----------------------------------------------------------------------------------#  ## Use Ward's method y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 5, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Use data splitting for big data y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = TRUE, kH = NULL,     members = NULL, nSplit = 10, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Use hybrid Ward-Regional method y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = TRUE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) ## Check senitivity to kH for the hybrid method above"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"multivariate-clustering","dir":"","previous_headings":"Examples","what":"Multivariate Clustering","title":"Hierarchical Climate Regionalization","text":"⇪","code":"#----------------------------------------------------------------------------------# # Typical use of HiClimR for multivariate clustering:                              # #----------------------------------------------------------------------------------#  ## Load the test data included/loaded in the package (1 degree resolution) x1 <- TestCase$x lon <- TestCase$lon lat <- TestCase$lat   ## Generate/check longitude and latitude mesh vectors for gridded data  xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat))  lon <- c(xGrid$lon)  lat <- c(xGrid$lat)  ## Test if we can replicate single-variate region map with repeated variable y <- HiClimR(x=list(x1, x1), lon = lon, lat = lat, lonStep = 1, latStep = 1,     geogMask = FALSE, continent = \"Africa\", meanThresh = list(10, 10),     varThresh = list(0, 0), detrend = list(TRUE, TRUE), standardize = list(TRUE, TRUE),     nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Generate a random matrix with the same number of rows x2 <- matrix(rnorm(nrow(x1) * 100, mean=0, sd=1), nrow(x1), 100)  ## Multivariate Hierarchical Climate Regionalization y <- HiClimR(x=list(x1, x2), lon = lon, lat = lat, lonStep = 1, latStep = 1,     geogMask = FALSE, continent = \"Africa\", meanThresh = list(10, NULL),     varThresh = list(0, 0), detrend = list(TRUE, FALSE), standardize = list(TRUE, TRUE),     weightMVC = list(1, 1), nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) ## You can apply all clustering methods and options"},{"path":"https://hsbadr.github.io/HiClimR/index.html","id":"miscellaneous-examples","dir":"","previous_headings":"Examples","what":"Miscellaneous Examples","title":"Hierarchical Climate Regionalization","text":"⇪","code":"#----------------------------------------------------------------------------------# # Miscellaneous examples to provide more information about functionality and usage # # of the helper functions that can be used separately or for other applications.   # #----------------------------------------------------------------------------------#  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Coarsening spatial resolution xc <- coarseR(x = x, lon = lon, lat = lat, lonStep = 2, latStep = 2) lon <- xc$lon lat <- xc$lat x <- xc$x  ## Use fastCor function to compute the correlation matrix t0 <- proc.time(); xcor <- fastCor(t(x)); proc.time() - t0 ## compare with cor function t0 <- proc.time(); xcor0 <- cor(t(x)); proc.time() - t0  ## Check the valid options for geographic masking geogMask()  ## geographic mask for Africa gMask <- geogMask(continent = \"Africa\", lon = lon, lat = lat, plot = TRUE,     colPalette = NULL)  ## Hierarchical Climate Regionalization Without geographic masking y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,      continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,      standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,      members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,      plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## With geographic masking (you may specify the mask produced above to save time) y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = TRUE,      continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,      standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,      members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,      plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## With geographic masking and contiguity constraint ## Change contigConst as appropriate y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = TRUE,     continent = \"Africa\", contigConst = 1, meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Find minimum significant correlation at 95% confidence level rMin <- minSigCor(n = nrow(x), alpha = 0.05, r = seq(0, 1, by = 1e-06))  ## Validtion of Hierarchical Climate Regionalization z <- validClimR(y, k = 12, minSize = 1, alpha = 0.01, plot = TRUE, colPalette = NULL)  ## Apply minimum cluster size (minSize = 25) z <- validClimR(y, k = 12, minSize = 25, alpha = 0.01, plot = TRUE, colPalette = NULL)  ## The optimal number of clusters, including small clusters k <- length(z$clustFlag)  ## The selected number of clusters, after excluding small clusters (if minSize > 1) ks <- sum(z$clustFlag)  ## Dendrogram plot plot(y, hang = -1, labels = FALSE)  ## Tree cut cutTree <- cutree(y, k = k) table(cutTree)  ## Visualization for gridded data RegionsMap <- matrix(y$region, nrow = length(unique(y$coords[, 1])), byrow = TRUE) colPalette <- colorRampPalette(c(\"#00007F\", \"blue\", \"#007FFF\", \"cyan\",     \"#7FFF7F\", \"yellow\", \"#FF7F00\", \"red\", \"#7F0000\")) image(unique(y$coords[, 1]), unique(y$coords[, 2]), RegionsMap, col = colPalette(ks))  ## Visualization for gridded or ungridded data plot(y$coords[, 1], y$coords[, 2], col = colPalette(max(y$region, na.rm = TRUE))[y$region], pch = 15, cex = 1) ## Change pch and cex as appropriate!  ## Export region map and mean timeseries into NetCDF-4 file library(ncdf4) y.nc <- HiClimR2nc(y=y, ncfile=\"HiClimR.nc\", timeunit=\"years\", dataunit=\"mm\") ## The NetCDF-4 file is still open to add other variables or close it nc_close(y.nc)"},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":null,"dir":"Reference","previous_headings":"","what":"Hierarchical Climate Regionalization — HiClimR","title":"Hierarchical Climate Regionalization — HiClimR","text":"HiClimR tool Hierarchical Climate Regionalization   applicable correlation-based clustering. Climate regionalization process   dividing area smaller regions homogeneous respect specified   climatic metric. Several features added facilitate applications climate   regionalization (spatiotemporal analysis general) implement cluster validation   objective tree cutting find optimal number clusters user-specified   confidence level. include options preprocessing postprocessing well   efficient code execution large datasets options splitting big data   computing upper-triangular half correlation/dissimilarity matrix   overcome memory limitations. Hybrid hierarchical clustering reconstructs upper part   tree cut get best available methods. Multivariate clustering   (MVC) provides options filtering variables preprocessing, detrending   standardization variable, applying weights preprocessed variables.   correlation distance MVC represents (weighted) average distances   variables. HiClimR main function calls helper functions. adds   several features new clustering method (called, regional linkage)   hierarchical clustering R (hclust function stats library):   data regridding (grid2D function), coarsening spatial resolution   (coarseR function), geographic masking (geogMask function),   contiguity-constrained clustering, data filtering mean /variance thresholds,   data preprocessing (detrending, standardization, PCA), faster correlation function   (fastCor function), hybrid hierarchical clustering, multivariate clustering   (MVC), cluster validation (validClimR minSigCor functions),   visualization regionalization results, exporting region map mean timeseries   NetCDF-4 file. Badr et al. (2015) describes regionalization algorithms, features, data processing   tools included package presents demonstration application package   used regionalize Africa basis interannual precipitation variability. HiClimR applicable correlation-based clustering.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hierarchical Climate Regionalization — HiClimR","text":"","code":"HiClimR(    # Input data matrix (N spatial elements x M observations)   x = list(),    # Geographic coordinates   lon = NULL, lat = NULL,    # Coarsening spatial resolution   lonStep = 1, latStep = 1,    # Geographic masking:   geogMask = FALSE, gMask = NULL, continent = NULL, region = NULL, country = NULL,    # Contiguity constraint:   contigConst = 0,    # Data thresholds:   meanThresh = if (inherits(x, \"list\")) {       vector(\"list\", length(x))   } else {       list(NULL)   },   varThresh = if (inherits(x, \"list\")) {       as.list(rep(0, length(x)))   } else {       list(0)   },    # Data preprocessing:   detrend = if (inherits(x, \"list\")) {       as.list(rep(FALSE, length(x)))   } else {       list(FALSE)   },   standardize = if (inherits(x, \"list\")) {       as.list(rep(FALSE, length(x)))   } else {       list(FALSE)   },   weightMVC = if (inherits(x, \"list\")) {       as.list(rep(1, length(x)))   } else {       list(1)   },   nPC = NULL,    # Clustering options:   method = \"ward\", hybrid = FALSE, kH = NULL, members = NULL,    # Big data support:   nSplit = 1, upperTri = TRUE, verbose = TRUE,    # Cluster validation:   validClimR = TRUE, rawStats = TRUE, k = NULL, minSize = 1, alpha = 0.05,    # Graphical options:   plot = TRUE, dendrogram = TRUE, colPalette = NULL,   hang = -1, labels = FALSE, pch = 15, cex = 1    )"},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hierarchical Climate Regionalization — HiClimR","text":"x (N rows M columns) matrix 'double' values:   N objects (spatial points stations) clustered M   observations (temporal points years). gridded data, N   objects created original matrix x0 using   .vector(t(x0)), x0 (n rows   m columns) matrix, n = length(unique(lon))   m = length(unique(lat)). Zero-variance rows (e.g., stations   zero variability) /missing values (e.g., years missing   observations) allowed. zero-variance rows columns   missing values removed. However, recommended take care   zero-variance rows missing values clustering.   Multivariate Clustering (MVC), x can list nvar matrices   nvar variables (one matrix variable). matrixes   x list number rows (objects: spatial points stations)   Data preprocessing specified lists meanThresh, varThresh,   detrend, standardize length x   length(x) = nvar. variable separately preprocessed allow   possible options. However, strongly recommended standardize variables   since magnitude range different.   Note : gridded data, rows input data matrix variable   ordered longitudes (check TestCase$x details). lon vector longitudes length N. Longitudes takes   values -180 180 (0 360).   gridded data, length may value (n) provided   n * m = N n = length(unique(lon)) m = length(unique(lat)). lat vector latitudes length N m. See lon. lonStep integer greater equal 1 longitude   step coarsen gridded data longitudinal direction. lonStep = 1,   gridded data coarsened longitudinal direction (default).   lonStep = 2, every grid longitudinal direction retained. latStep integer greater equal 1 latitude   step coarsen gridded data latitudinal direction. latStep = 1,   gridded data coarsened latitudinal direction (default).   latStep = 2, every grid latitudinal direction retained.   lonStep latStep independent user can optionally   apply different coarsening level dimension. geogMask logical: geogMask = TRUE, geogMask   function called. Additional arguments required.   requires longitude latitude vector together string   (array strings) specify continent, region   name(s), country ISO3 character code(s). gMask != NULL,   provided gmask vector used geographic masking without   calling geogMask. gMask vector indices spatial elements masked,   required HiClimR. typically output vector   geogMask function. helps saving time   geographic mask used many times. continent NULL string (array strings) specify   continent name(s): one continent, region,    country specified. Valid list continent names   can obtained running geogMask(). region NULL string (array strings) specify   region name(s): one continent, region,   country specified. Valid list region names   can obtained running geogMask(). country NULL string (array strings) specify   country ISO3 character code(s): one continent,   region, country specified. Valid list   country ISO3 character code(s) can obtained running   geogMask(). contigConst 0 positive value contiguity constraint:   used apply weighted geographic distances initial   dissimilarity matrix variable(s) data matrix x.   positive real value (contigConst > 0, recommended   0 1) contigConst = 0 means clustering   completely based data constraints contiguity   contigConst > 0 gives priority merging contiguous points.   Geographic coordinates lon lat required compute   geographic distances.   regional linkage method support contiguity constraints. meanThresh NULL threshold temporal mean:   used varThresh mask zero- near-zero-variance   data, Observations mean less equal meanThresh   removed. meanThresh = NULL, varThresh   used either mask zero-variance data default increased   variance threshold mask near-zero-variance data.   Multivariate Clustering (MVC), meanThresh list thresholds   length x length(x) = nvar.   variable separately preprocessed allow possible options.   However, strongly recommended standardize variables since   magnitude range different. varThresh zero threshold temporal variance:   used meanThresh mask zero- near-zero-variance data,   Observations variance less equal varThresh   removed. varThresh = 0, zero-variance data   masked (default).   Multivariate Clustering (MVC), varThresh list thresholds   length x length(x) = nvar.   variable separately preprocessed allow possible options.   However, strongly recommended standardize variables since   magnitude range different. detrend logical: data detrended clustering?   Detrending (removing linear trend) important variations   temporal point another interest (e.g., interannual variability).   columns data matrix x temporally ordered (constant   step size) appropriate names (e.g., colnames(x) = years[1:M]).   Multivariate Clustering (MVC), detrend list thresholds   length x length(x) = nvar.   variable separately preprocessed allow possible options.   However, strongly recommended standardize variables since   magnitude range different. standardize logical: data standardized   clustering? standardized data makes use mean equally-weighted   objects within cluster (cluster mean = mean standardized variables   within cluster). Otherwise, mean raw data used (cluster   mean = mean raw variables within cluster). variance mean   updated agglomeration step.   Multivariate Clustering (MVC), standardize list thresholds   length x length(x) = nvar.   variable separately preprocessed allow possible options.   However, strongly recommended standardize variables since   magnitude range different. weightMVC list positive wights (weightMVC > 0)   Multivariate Clustering (MVC) length x   length(x) = number variables. filtered variables   weighted combined column (object: spatial points stations)   preprocessing (detrending standardization) PCA (requested)   computing correlation/dissimilarity matrix. default weight   weightMVC = 1 variables. nPC NULL number principal components (PCs) retained.   nPC = NULL, raw data used clustering.   Otherwise, data filtered reconstructed using nPC PCs   obtained SVD-based PCA. detrend /standardize   options applied, requested, PCA. method agglomeration method used. (  unambiguous abbreviation ) one \"regional\", \"ward\",   \"single\", \"complete\", \"average\", \"mcquitty\",   \"median\" \"centroid\". default \"ward\" method. hybrid logical: upper part tree reconstructed   using regional linkage clustering method?   adds hybrid hierarchical clustering feature get best   available methods. utilizes pros available methods, especially   better overall homogeneity ward's method separation,   contiguity, objective tree cut regional linkage method.   hybrid = FALSE, default clustering using selected   method used (.e., hybrid clustering).Otherwise, upper part   tree reconstructed cut kH clusters using   regional linkage method. Note: hybrid option redundant   using regional linkage main clustering method. kH NULL integer number regions/clusters   upper part tree reconstructed regional linkage method,   hybrid = TRUE. kH = NULL, tree reconstructed   upper part first merging cost larger mean merging cost   entire tree. hybrid clustering requested, updated upper part   tree used cluster validation, kH   greater final number clusters k, selected. members NULL vector length size d.   See ‘Details’ section. nSplit integer number greater equal one, split data matrix   nSplit splits total number columns ncol(xt). nSplit = 1,   default method used compute correlation matrix full data matrix   (splits). nSplit > 1, correlation matrix (upper-triangular part   upperTri = TRUE) allocated filled computed correlation   sub-matrix split. first n-1 splits equal size last   split may include remaining columns. used upperTri = TRUE   compute upper-triangular part correlation matrix. maximum number   splits nSplitMax = floor(N / 2) makes splits 2 columns;   nSplit > nSplitMax, nSplitMax used. large number splits   nSplit makes computation slower handle big data available   memory enough allocate correlation matrix, helps solving   “Error: allocate vector size...” memory limitation problem.   recommended start small number splits. data large   compared physical memory, highly recommended use 64-Bit machine   enough memory resources /use coarsening feature gridded data setting   lonStep > 1 latStep > 1. upperTri logical compute upper-triangular half correlation   matrix upperTri = TRUE nSplit > 1., includes required info   since correlation/dissimilarity matrix symmetric. almost halves memory use,   can important big data. verbose logical print processing information verbose = TRUE. validClimR logical: validClimR = TRUE, validClimR   called compute validation indices including statistical summary   inter- intra-cluster correlations. computationally expensive. can   also objectively cut dendrogram tree regional clustering method,   k = NULL. rawStats logical: validation indices computed based   raw data PCA-filtered data? k NULL integer k > 1 number regions/clusters.   regional linkage method, k = NULL supported,   \"optimal\" number regions used user specified significance   level alpha. required specify number clusters k   methods, since based inter-cluster correlation.   k = NULL methods (except regional) linkage,   validClimR aborted. One can use validClimR function   compute inter-cluster correlation different number clusters objectively   cut tree methods, computationally expensive   cover entire merging history large number spatial elements. minSize minimum cluster size. regional linkage method tend   isolate noisy data small clusters. minSize can used   exclude small clusters statSum statistical   summary, likely noisy data need checked   quality control step. analysis may repeated. alpha confidence level: default alpha = 0.05   95% confidence level. plot logical call plotting method plot = TRUE. dendrogram logical enable disable dendrogram plotting. colPalette color palette list colors generated   rainbow, heat.colors, topo.colors,   terrain.colors similar functions. hang fraction plot height labels hang     rest plot.     negative value cause labels hang 0. labels character vector labels leaves     tree. default row names row numbers original data     used. labels = FALSE labels plotted. pch Either integer specifying symbol single character   used default plotting points. See points   possible values. cex numerical value giving amount plotting symbols   magnified relative default = 1.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hierarchical Climate Regionalization — HiClimR","text":"object class HiClimR hclust,   describes tree produced clustering process.   object list following components: merge \\(n-1\\) 2 matrix.     Row \\(\\) merge describes merging clusters     step \\(\\) clustering.     element \\(j\\) row negative,     observation \\(-j\\) merged stage.     \\(j\\) positive merge     cluster formed (earlier) stage \\(j\\)     algorithm.     Thus negative entries merge indicate agglomerations     singletons, positive entries indicate agglomerations     non-singletons. height set \\(n-1\\) real values (non-decreasing     ultrametric trees).     clustering height: , value     criterion associated clustering     method particular agglomeration. order vector giving permutation original     observations suitable plotting, sense cluster     plot using ordering matrix merge     crossings branches. labels labels objects clustered. method cluster method used. call call produced result. dist.method distance used create d     (returned distance object \"method\"     attribute). skip vector lonStep latStep coarseR = TRUE. PCA nPC != NULL, eigenvalues, explained variance,     accumulated variance stored . coords (Nc rows 2 columns) matrix 'double' values:     longitude latitude coordinates preprocessed data used clustering,     NC number spatial elements clustered coarsening     spatial resolution lonStep latStep. returned     lon lat vectors defined. similar provided     lon lat lonStep = 1 latStep = 1. nvars number variables used multivariate clustering (MVC). ncols number columns variable. data preprocessed data used clustering stored .     rawData = TRUE nPC != NULL, preprocessed data without     filtering (PCA) returned . mask vector indices masked spatial points     geographic masking data thresholds. treeH object class hclust, describes upper part     tree reconstructed hybrid clustering process hybrid = TRUE. validClimR = TRUE, object class HiClimR, produces   indices validating tree produced clustering process, merged   dendrogram tree . object list following components: cutLevel minimum significant correlation used objective     tree cut together corresponding confidence level. clustMean cluster means region's mean timeseries     selected regions. clustSize cluster sizes selected regions. clustFlag flag 0 1 indicate cluster used     statSum validation indices (interCor,     intraCor, diffCor, statSum), based     minSize minimum cluster size.     clustFlag = 0, cluster excluded size     less minSize minimum cluster size. sum     clustFlag elements represents selected number clusters. interCor inter-cluster correlations selected regions.     inter-cluster correlations cluster means. maximum inter-cluster     correlation measure separation contiguity,     used objective tree cut (find \"optimal\" number clusters). intraCor intra-cluster correlations selected regions.     intra-cluster correlations mean cluster     members. average intra-cluster correlation weighted average     clusters, measure homogeneity. diffCor difference intra-cluster correlation maximum   \tinter-cluster correlation selected regions. statSum overall statistical summary interCluster,     intraCor, diffCor. region ordered regions vector size N number spatial   \telements selected number clusters, excluding   \tsmall clusters defined minSize argument. regionID ordered regions ID vector length equals selected number   \tclusters, excluding small clusters defined minSize argument.   \thelps mapping ordered regions actual names ordering.   \tregion component uses ordered ID, components use   \tnames used clustering process. print, plot identify  (see identify.hclust) methods rect.hclust() functions hclust objects.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hierarchical Climate Regionalization — HiClimR","text":"HiClimR function based hclust, now uses   optimized algorithm deal upper/lower triangular-half symmetric   dissimilarity matrix instead old algorithm uses full matrix   merging steps. performs hierarchical cluster analysis using Pearson correlation   distance dissimilarity \\(N\\) objects clustered. Initially, object   assigned cluster algorithm proceeds iteratively,   stage joining two similar clusters, continuing just single   cluster. stage distances clusters recomputed dissimilarity   update formula according particular clustering method used. clustering methods hclust included. regional   linkage method minimizes inter-cluster correlations cluster means   (see Badr et al. 2015). Ward's minimum variance method aims finding   compact, spherical clusters. complete linkage method finds similar clusters.   single linkage method (closely related minimal spanning tree)   adopts ‘friends friends’ clustering strategy. methods can   regarded aiming clusters characteristics somewhere single   complete link methods. Note however, methods \"median\" \"centroid\"   leading monotone distance measure, equivalently   resulting dendrograms can called inversions (hard interpret). regional linkage method explained context spatiotemporal   problem, N spatial elements (e.g., weather stations) divided   k regions, given element time series length M.   based inter-regional correlation distance temporal means   different regions (elements first merging step). modifies update   formulae average linkage method incorporating standard deviation   merged region timeseries,  function correlation   individual regions, standard deviations merging. equal   average standard deviations correlation two   merged regions 100%. special case, regional linkage   method reduced classic average linkage clustering method. members != NULL, d taken   dissimilarity matrix clusters instead dissimilarities   singletons members gives number observations   per cluster.  way hierarchical cluster algorithm can   ‘started middle dendrogram’, e.g., order   reconstruct part tree cut (see examples).   Dissimilarities clusters can efficiently computed (.e.,   without hclust ) limited number   distance/linkage combinations, simplest one squared   Euclidean distance centroid linkage.  case   dissimilarities clusters squared Euclidean   distances cluster means. hierarchical cluster displays, decision needed merge   specify subtree go left right.   Since, \\(n\\) observations \\(n-1\\) merges,   \\(2^{(n-1)}\\) possible orderings leaves   cluster tree, dendrogram.   algorithm used hclust order subtree   tighter cluster left (last, .e., recent,   merge left subtree lower value last   merge right subtree).   Single observations tightest clusters possible,   merges involving two observations place order   observation sequence number.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hierarchical Climate Regionalization — HiClimR","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR. Wilks, D. S. (2011):   Statistical methods atmospheric sciences,   Academic press. Gordon, . D. (1999):   Classification. Second Edition.   London: Chapman Hall / CRC Becker, R. ., Chambers, J. M. Wilks, . R. (1988):   New S Language.   Wadsworth & Brooks/Cole. (S version.) Murtagh, F. (1985):   “Multidimensional Clustering Algorithms”,   COMPSTAT Lectures 4.   Wuerzburg: Physica-Verlag   (algorithmic details algorithms used). Hartigan, J. . (1975):   Clustering  Algorithms.   New York: Wiley. Everitt, B. (1974):   Cluster Analysis.   London: Heinemann Educ. Books. Anderberg, M. R. (1973):   Cluster Analysis Applications.   Academic Press: New York. Sneath, P. H. . R. R. Sokal (1973):   Numerical Taxonomy.   San Francisco: Freeman. McQuitty, L.L. (1966):   Similarity Analysis Reciprocal Pairs Discrete Continuous Data.   Educational Psychological Measurement, 26, 825-831. Source Code: https://github.com/hsbadr/HiClimR","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Hierarchical Climate Regionalization — HiClimR","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>. HiClimR   modification hclust function, based   Fortran code contributed STATLIB F. Murtagh.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hierarchical Climate Regionalization — HiClimR","text":"","code":"require(HiClimR)  #----------------------------------------------------------------------------------# # Typical use of HiClimR for single-variate clustering:                            # #----------------------------------------------------------------------------------#  ## Load the test data included/loaded in the package (1 degree resolution) x <- TestCase$x lon <- TestCase$lon lat <- TestCase$lat  ## Generate/check longitude and latitude mesh vectors for gridded data xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Single-Variate Hierarchical Climate Regionalization y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) #>  #> PROCESSING STARTED #>  #> Checking Multivariate Clustering (MVC)... #> ---> x is a matrix #> ---> single-variate clustering: 1 variable #> Checking data... #> ---> Checking dimensions... #> ---> Checking row names... #> ---> Checking column names... #> Data filtering... #> ---> Computing mean for each row... #> ---> Checking rows with mean bellow meanThresh... #> ---> 4678 rows found, mean ≤  10 #> ---> Computing variance for each row... #> ---> Checking rows with near-zero-variance... #> ---> 3951 rows found, variance ≤  0 #> Data preprocessing... #> ---> Applying mask... #> ---> Checking columns with missing values... #> ---> Removing linear trend... #> ---> Standardizing data... #> Agglomerative Hierarchical Clustering... #> ---> Computing correlation/dissimilarity matrix... #> ---> Starting clustering process... #> ---> Constructing dendrogram tree... #> Calling cluster validation... #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map... #>  #> PROCESSING COMPLETED #>  #> Running Time: #>    user  system elapsed  #>   0.639   0.052   0.714  #> Time difference of 0.714329 secs  ## For more examples: https://github.com/hsbadr/HiClimR#examples  if (FALSE) {  #----------------------------------------------------------------------------------# # Additional Examples:                                                             # #----------------------------------------------------------------------------------#  ## Use Ward's method y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Use data splitting for big data y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = TRUE, kH = NULL,     members = NULL, nSplit = 10, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Use hybrid Ward-Regional method y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = TRUE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) ## Check senitivity to kH for the hybrid method above   #----------------------------------------------------------------------------------# # Typical use of HiClimR for multivariate clustering:                              # #----------------------------------------------------------------------------------#  ## Load the test data included/loaded in the package (1 degree resolution) x1 <- TestCase$x lon <- TestCase$lon lat <- TestCase$lat  ## Generate/check longitude and latitude mesh vectors for gridded data xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Test if we can replicate single-variate region map with repeated variable y <- HiClimR(x=list(x1, x1), lon = lon, lat = lat, lonStep = 1, latStep = 1,     geogMask = FALSE, continent = \"Africa\", meanThresh = list(10, 10),     varThresh = list(0, 0), detrend = list(TRUE, TRUE), standardize = list(TRUE, TRUE),     nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Generate a random matrix with the same number of rows x2 <- matrix(rnorm(nrow(x1) * 100, mean=0, sd=1), nrow(x1), 100)  ## Multivariate Hierarchical Climate Regionalization y <- HiClimR(x=list(x1, x2), lon = lon, lat = lat, lonStep = 1, latStep = 1,     geogMask = FALSE, continent = \"Africa\", meanThresh = list(10, NULL),     varThresh = list(0, 0), detrend = list(TRUE, FALSE), standardize = list(TRUE, TRUE),     weightMVC = list(1, 1), nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) ## You can apply all clustering methods and options  #----------------------------------------------------------------------------------# # Miscellaneous examples to provide more information about functionality and usage # # of the helper functions that can be used separately or for other applications.   # #----------------------------------------------------------------------------------#  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Coarsening spatial resolution xc <- coarseR(x = x, lon = lon, lat = lat, lonStep = 2, latStep = 2) lon <- xc$lon lat <- xc$lat x <- xc$x  ## Use fastCor function to compute the correlation matrix t0 <- proc.time(); xcor <- fastCor(t(x)); proc.time() - t0 ## compare with cor function t0 <- proc.time(); xcor0 <- cor(t(x)); proc.time() - t0  ## Check the valid options for geographic masking geogMask()  ## geographic mask for Africa gMask <- geogMask(continent = \"Africa\", lon = lon, lat = lat, plot = TRUE,     colPalette = NULL)  ## Hierarchical Climate Regionalization Without geographic masking y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## With geographic masking (you may specify the mask produced above to save time) y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = TRUE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## With geographic masking and contiguity contraint ## Change contigConst as appropriate y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = TRUE,     continent = \"Africa\", contigConst = 1, meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE, kH = NULL,     members = NULL, nSplit = 1, upperTri = TRUE, verbose = TRUE,     validClimR = TRUE, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE)  ## Find minimum significant correlation at 95 rMin <- minSigCor(n = nrow(x), alpha = 0.05, r = seq(0, 1, by = 1e-06))  ## Validtion of Hierarchical Climate Regionalization z <- validClimR(y, k = 12, minSize = 1, alpha = 0.01,     plot = TRUE, colPalette = NULL)  ## Apply minimum cluster size (minSize = 25) z <- validClimR(y, k = 12, minSize = 25, alpha = 0.01,     plot = TRUE, colPalette = NULL)  ## The optimal number of clusters, including small clusters k <- length(z$clustFlag)  ## The selected number of clusters, after excluding small clusters (if minSize > 1) ks <- sum(z$clustFlag)  ## Dendrogram plot plot(y, hang = -1, labels = FALSE)  ## Tree cut cutTree <- cutree(y, k = k) table(cutTree)  ## Visualization for gridded data RegionsMap <- matrix(y$region, nrow = length(unique(y$coords[, 1])), byrow = TRUE) colPalette <- colorRampPalette(c(\"#00007F\", \"blue\", \"#007FFF\", \"cyan\",     \"#7FFF7F\", \"yellow\", \"#FF7F00\", \"red\", \"#7F0000\")) image(unique(y$coords[, 1]), unique(y$coords[, 2]), RegionsMap, col = colPalette(ks))  ## Visualization for gridded or ungridded data plot(y$coords[, 1], y$coords[, 2], col = colPalette(max(Regions, na.rm = TRUE))[y$region],     pch = 15, cex = 1)  ## Export region map and mean timeseries into NetCDF-4 file y.nc <- HiClimR2nc(y=y, ncfile=\"HiClimR.nc\", timeunit=\"years\", dataunit=\"mm\") ## The NetCDF-4 file is still open to add other variables or close it nc_close(y.nc)  }"},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":null,"dir":"Reference","previous_headings":"","what":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"HiClimR2nc helper function exports region map   mean timeseries NetCDF-4 file, using ncdf4 package.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"","code":"HiClimR2nc(y = NULL, ncfile = \"HiClimR.nc\", timeunit = \"\", dataunit = \"\")"},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"y dendrogram tree produced HiClimR. ncfile Path name NetCDF-4 file created. timeunit optional character string time units,   zero-length string (default: timeunit=\"\") removes units attribute. dataunit optional character string data units,   zero-length string (default: timeunit=\"\") removes units attribute.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"object class ncdf4, fields described nc_open.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"HiClimR2nc function exports region map mean timeseries   HiClimR tree NetCDF-4 file, using ncdf4 package.   NetCDF-4 file open add variables, needed.   important close created file using nc_close,   flushes unwritten data disk.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/HiClimR2nc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export NetCDF-4 file for Hierarchical Climate Regionalization — HiClimR2nc","text":"","code":"require(HiClimR) require(ncdf4) #> Loading required package: ncdf4  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Hierarchical Climate Regionalization y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE,     kH = NULL, members = NULL, validClimR = TRUE, k = 12, minSize = 1,     alpha = 0.01, plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) #>  #> PROCESSING STARTED #>  #> Checking Multivariate Clustering (MVC)... #> ---> x is a matrix #> ---> single-variate clustering: 1 variable #> Checking data... #> ---> Checking dimensions... #> ---> Checking row names... #> ---> Checking column names... #> Data filtering... #> ---> Computing mean for each row... #> ---> Checking rows with mean bellow meanThresh... #> ---> 4678 rows found, mean ≤  10 #> ---> Computing variance for each row... #> ---> Checking rows with near-zero-variance... #> ---> 3951 rows found, variance ≤  0 #> Data preprocessing... #> ---> Applying mask... #> ---> Checking columns with missing values... #> ---> Removing linear trend... #> ---> Standardizing data... #> Agglomerative Hierarchical Clustering... #> ---> Computing correlation/dissimilarity matrix... #> ---> Starting clustering process... #> ---> Constructing dendrogram tree... #> Calling cluster validation... #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map... #>  #> PROCESSING COMPLETED #>  #> Running Time: #>    user  system elapsed  #>   0.514   0.013   0.526  #> Time difference of 0.5256941 secs  if (FALSE) {  ## Export region map and mean timeseries into NetCDF-4 file y.nc <- HiClimR2nc(y=y, ncfile=\"HiClimR.nc\", timeunit=\"years\", dataunit=\"mm\") ## The NetCDF-4 file is still open to add other variables or close it nc_close(y.nc)  }"},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"data subset University East Anglia Climatic Research Unit   (CRU) TS (timeseries) precipitation dataset version 3.2.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"","code":"data(TestCase)"},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"TestCase list three components: x, lon, lat.   x (6400 rows 41 columns) matrix required   HiClimR function. rows represent spatial points (stations),   columns represent observations (temporal points years). lon   lat vectors length 80 unique longitudes   latitudes coordinates, 80 * 80 = 6400 gridded data.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"CRU TS 3.21 data (1901-2012) monthly gridded precipitation 0.5   degree resolution. test data subset 1 degree resolution   African precipitation January, 1949-1989.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"Climatic Research Unit (CRU) time-series datasets variations climate   variations phenomena.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR. Harris, ., Jones, P. D., Osborn, T. J., Lister, D. H. (2014):   Updated high-resolution grids monthly climatic observations - CRU TS3.10 Dataset,   International journal climatology, 34, 623-642,   doi: 10.1002/joc.3711 .","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/TestCase.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test Data for Functionality Demonstration of HiClimR Package — TestCase","text":"","code":"require(HiClimR)  x <- TestCase$x dim(x) #> [1] 6400   41 colnames(x) #>  [1] \"1949\" \"1950\" \"1951\" \"1952\" \"1953\" \"1954\" \"1955\" \"1956\" \"1957\" \"1958\" #> [11] \"1959\" \"1960\" \"1961\" \"1962\" \"1963\" \"1964\" \"1965\" \"1966\" \"1967\" \"1968\" #> [21] \"1969\" \"1970\" \"1971\" \"1972\" \"1973\" \"1974\" \"1975\" \"1976\" \"1977\" \"1978\" #> [31] \"1979\" \"1980\" \"1981\" \"1982\" \"1983\" \"1984\" \"1985\" \"1986\" \"1987\" \"1988\" #> [41] \"1989\""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":null,"dir":"Reference","previous_headings":"","what":"World Mask for Geographic Masking in HiClimR — WorldMask","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"data used geographic masking geogMask   function HiClimR package.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"","code":"data(WorldMask)"},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"WorldMask list two components: info mask.   info (284 rows 10 columns) matrix. rows   areas countries columns codes required geogMask.   mask (3601 rows 1801 columns) matrix integer   values 1 284 areas defined info.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"data used internally geogMask function geographic masking   HiClimR package. user advised refer function manual   details. world mask available 0.1 degree (10 km) resolution.   info data provides information continents, regions, country codes).","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"data based Humanitarian Information Unit (HIU) Large Scale   International Boundaries (LSIB) dataset.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR. LSIB Data: https://hiu.state.gov/data/.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/WorldMask.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"World Mask for Geographic Masking in HiClimR — WorldMask","text":"","code":"require(HiClimR)  geogMask() #> ---> Checking geographic masking options... #> $continent #> [1] \"Africa\"     \"Americas\"   \"Antarctica\" \"Asia\"       \"Europe\"     #> [6] \"Oceania\"    #>  #> $region #>  [1] \"Antarctica\"                \"Australia and New Zealand\" #>  [3] \"Caribbean\"                 \"Central America\"           #>  [5] \"Central Asia\"              \"Eastern Africa\"            #>  [7] \"Eastern Asia\"              \"Eastern Europe\"            #>  [9] \"Melanesia\"                 \"Micronesia\"                #> [11] \"Middle Africa\"             \"Northern Africa\"           #> [13] \"Northern America \"         \"Northern Europe\"           #> [15] \"Polynesia\"                 \"South America\"             #> [17] \"South-Eastern Asia\"        \"Southern Africa\"           #> [19] \"Southern Asia\"             \"Southern Europe\"           #> [21] \"Western Africa\"            \"Western Asia\"              #> [23] \"Western Europe\"            #>  #> $country #>   [1] \"ABW\" \"AFG\" \"AGO\" \"AIA\" \"ALB\" \"AND\" \"ANT\" \"ARE\" \"ARG\" \"ARM\" \"ASM\" \"ATA\" #>  [13] \"ATF\" \"ATG\" \"AUS\" \"AUT\" \"AZE\" \"BDI\" \"BEL\" \"BEN\" \"BFA\" \"BGD\" \"BGR\" \"BHR\" #>  [25] \"BHS\" \"BIH\" \"BLM\" \"BLR\" \"BLZ\" \"BMU\" \"BOL\" \"BRA\" \"BRB\" \"BRN\" \"BTN\" \"BVT\" #>  [37] \"BWA\" \"CAF\" \"CAN\" \"CCK\" \"CHE\" \"CHL\" \"CHN\" \"CIV\" \"CMR\" \"COD\" \"COG\" \"COK\" #>  [49] \"COL\" \"COM\" \"CPV\" \"CRI\" \"CUB\" \"CUW\" \"CXR\" \"CYM\" \"CYP\" \"CZE\" \"DEU\" \"DJI\" #>  [61] \"DMA\" \"DNK\" \"DOM\" \"DZA\" \"ECU\" \"EGY\" \"ERI\" \"ESH\" \"ESP\" \"EST\" \"ETH\" \"FIN\" #>  [73] \"FJI\" \"FLK\" \"FRA\" \"FRO\" \"FSM\" \"GAB\" \"GBR\" \"GEO\" \"GGY\" \"GHA\" \"GIN\" \"GLP\" #>  [85] \"GMB\" \"GNB\" \"GNQ\" \"GRC\" \"GRD\" \"GRL\" \"GTM\" \"GUF\" \"GUM\" \"GUY\" \"HKG\" \"HMD\" #>  [97] \"HND\" \"HRV\" \"HTI\" \"HUN\" \"IDN\" \"IMN\" \"IND\" \"IOT\" \"IRL\" \"IRN\" \"IRQ\" \"ISL\" #> [109] \"ISR\" \"ITA\" \"JAM\" \"JEY\" \"JOR\" \"JPN\" \"KAZ\" \"KEN\" \"KGZ\" \"KHM\" \"KIR\" \"KNA\" #> [121] \"KOR\" \"KWT\" \"LAO\" \"LBN\" \"LBR\" \"LBY\" \"LCA\" \"LIE\" \"LKA\" \"LSO\" \"LTU\" \"LUX\" #> [133] \"LVA\" \"MAC\" \"MAF\" \"MAR\" \"MCO\" \"MDA\" \"MDG\" \"MDV\" \"MEX\" \"MHL\" \"MKD\" \"MLI\" #> [145] \"MLT\" \"MMR\" \"MNE\" \"MNG\" \"MNP\" \"MOZ\" \"MRT\" \"MSR\" \"MTQ\" \"MUS\" \"MWI\" \"MYS\" #> [157] \"MYT\" \"NAM\" \"NCL\" \"NER\" \"NFK\" \"NGA\" \"NIC\" \"NIU\" \"NLD\" \"NOR\" \"NPL\" \"NRU\" #> [169] \"NZL\" \"OMN\" \"PAK\" \"PAN\" \"PCN\" \"PER\" \"PHL\" \"PLW\" \"PNG\" \"POL\" \"PRI\" \"PRK\" #> [181] \"PRT\" \"PRY\" \"PSE\" \"PYF\" \"QAT\" \"REU\" \"ROU\" \"RUS\" \"RWA\" \"SAU\" \"SDN\" \"SEN\" #> [193] \"SGP\" \"SGS\" \"SHN\" \"SJM\" \"SLB\" \"SLE\" \"SLV\" \"SMR\" \"SOM\" \"SPM\" \"SSD\" \"STP\" #> [205] \"SUR\" \"SVK\" \"SVN\" \"SWE\" \"SWZ\" \"SXM\" \"SYC\" \"SYR\" \"TCA\" \"TCD\" \"TGO\" \"THA\" #> [217] \"TJK\" \"TKL\" \"TKM\" \"TLS\" \"TON\" \"TTO\" \"TUN\" \"TUR\" \"TUV\" \"TWN\" \"TZA\" \"UGA\" #> [229] \"UKR\" \"UMI\" \"URY\" \"USA\" \"UZB\" \"VAT\" \"VCT\" \"VEN\" \"VGB\" \"VIR\" \"VNM\" \"VUT\" #> [241] \"WLF\" \"WSM\" \"YEM\" \"ZAF\" \"ZMB\" \"ZWE\" #>"},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":null,"dir":"Reference","previous_headings":"","what":"Coarsening spatial resolution for gridded data — coarseR","title":"Coarsening spatial resolution for gridded data — coarseR","text":"coarseR helper function helps coarsening spatial   resolution input matrix HiClimR function.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coarsening spatial resolution for gridded data — coarseR","text":"","code":"coarseR(x = x, lon = lon, lat = lat, lonStep = 1, latStep = 1, verbose = TRUE)"},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coarsening spatial resolution for gridded data — coarseR","text":"x (N rows M columns) matrix 'double' values:   N objects (spatial points stations) clustered M   observations (temporal points years). gridded data, N   objects created original matrix x0 using   .vector(t(x0)), x0 (n rows   m columns) matrix, n = length(unique(lon))   m = length(unique(lat)). lon vector longitudes length N. gridded data,   length may value (n) provided n * m = N   n = length(unique(lon)) m = length(unique(lat)). lat vector latitudes length N m. See lon. lonStep integer greater equal 1 longitude   step coarsen gridded data longitudinal direction. lonStep = 1,   gridded data coarsened longitudinal direction (default).   lonStep = 2, every grid longitudinal direction retained. latStep integer greater equal 1 latitude   step coarsen gridded data latitudinal direction. latStep = 1,   gridded data coarsened latitudinal direction (default).   latStep = 2, every grid latitudinal direction retained.   lonStep latStep independent user can optionally   apply different coarsening level dimension. verbose logical print processing information verbose = TRUE.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coarsening spatial resolution for gridded data — coarseR","text":"list following components: lon longitude mesh vector coarsened data. lat latitude mesh vector coarsened data. rownum original row numbers coarsened data. x coarsened data input data matrix x.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Coarsening spatial resolution for gridded data — coarseR","text":"high-resolution data, computational memory requirements may   met old machines. function enables user use coarser data   spatial dimension:longitude, latitude, . available  testing   running HiClimR package old computers machines small memory   resources. rows output matrix (x component) also named   longitude latitude coordinates. lonStep = 1 latStep = 1,   coarseR function just rename rows matrix x.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Coarsening spatial resolution for gridded data — coarseR","text":"Hamada S. Badr, Zaitchik, B. F., Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F., Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Coarsening spatial resolution for gridded data — coarseR","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/coarseR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coarsening spatial resolution for gridded data — coarseR","text":"","code":"require(HiClimR)  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Coarsening spatial resolution xc <- coarseR(x = x, lon = lon, lat = lat, lonStep = 2, latStep = 2) lon <- xc$lon lat <- xc$lat x <- xc$x"},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast correlation for large matrices — fastCor","title":"Fast correlation for large matrices — fastCor","text":"fastCor helper function compute Pearson correlation matrix   HiClimR validClimR functions. similar   cor function R uses faster implementation 64-bit   machines (optimized BLAS library highly recommended). fastCor   also uses memory-efficient algorithm allows splitting data matrix   compute upper-triangular part correlation matrix. can used   compute correlation matrix columns data matrix.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast correlation for large matrices — fastCor","text":"","code":"fastCor(xt, nSplit = 1, upperTri = FALSE, optBLAS = FALSE, verbose = TRUE)"},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast correlation for large matrices — fastCor","text":"xt (M rows N columns) matrix 'double' values:   N objects (spatial points stations) clustered M   observations (temporal points years). transpose input   matrix x required HiClimR   validClimR functions. nSplit integer number greater equal one, split data matrix   nSplit splits total number columns ncol(xt). nSplit = 1,   default method used compute correlation matrix full data matrix   (splits). nSplit > 1, correlation matrix (upper-triangular part   upperTri = TRUE) allocated filled computed correlation   sub-matrix split. first n-1 splits equal size last   split may include remaining columns. used upperTri = TRUE   compute upper-triangular part correlation matrix. maximum number   splits nSplitMax = floor(N / 2) makes splits 2 columns;   nSplit > nSplitMax, nSplitMax used. large number splits   nSplit makes computation slower handle big data available   memory enough allocate correlation matrix, helps solving   “Error: allocate vector size...” memory limitation problem.   recommended start small number splits. data large   compared physical memory, highly recommended use 64-Bit machine   enough memory resources /use coarsening feature gridded data setting   lonStep > 1 latStep > 1. upperTri logical compute upper-triangular half correlation   matrix upperTri = TRUE nSplit > 1., includes required info   since correlation/dissimilarity matrix symmetric. almost halves memory use,   can important big data. optBLAS logical use optimized BLAS library installed optBLAS = TRUE   64-bit machines. verbose logical print processing information verbose = TRUE.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast correlation for large matrices — fastCor","text":"(N rows N columns) correlation matrix.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fast correlation for large matrices — fastCor","text":"fastCor function computes correlation matrix   calling cross product function Basic Linear Algebra Subroutines   (BLAS) library used R. significant performance improvement can   achieved building R 64-bit machines optimized BLAS library,   ATLAS, OpenBLAS, commercial Intel MKL.   big data, memory required allocate square matrix correlations   may exceed total amount physical memory available resulting   “Error: allocate vector size...”. fastCor allows   splitting data matrix nSplit splits computes   upper-triangular part correlation matrix upperTri = TRUE.   almost halves memory use, can important big data.   nSplit > 1, correlation matrix (upper-triangular part   upperTri = TRUE) allocated filled computed correlation   sub-matrix split. first n-1 splits equal size   last split may include remaining columns.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fast correlation for large matrices — fastCor","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fast correlation for large matrices — fastCor","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/fastCor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fast correlation for large matrices — fastCor","text":"","code":"require(HiClimR)  ## Load test case data x <- TestCase$x  ## Use fastCor function to compute the correlation matrix t0 <- proc.time() ; xcor <- fastCor(t(x)) ; proc.time() - t0 #> ---> Checking zero-variance data... #> --->\t Total number of variables:  6400 #> --->\t WARNING: 3951 variables found with zero variance #>    user  system elapsed  #>   0.666   0.136   0.801  ## compare with cor function t0 <- proc.time() ; xcor0 <- cor(t(x)) ; proc.time() - t0 #> Warning: the standard deviation is zero #>    user  system elapsed  #>   1.054   0.068   1.122   if (FALSE) {  ## Split the data into 10 splits and return upper-triangular half only xcor10 <- fastCor(t(x), nSplit = 10, upperTri = TRUE)  }"},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":null,"dir":"Reference","previous_headings":"","what":"Geographic mask from longitude and latitude — geogMask","title":"Geographic mask from longitude and latitude — geogMask","text":"geogMask helper function preprocess input   HiClimR via geogMask parameter.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geographic mask from longitude and latitude — geogMask","text":"","code":"geogMask(continent = NULL, region = NULL, country = NULL, lon = NULL, lat = NULL,   InDispute = TRUE, verbose = TRUE, plot = FALSE, colPalette = NULL, pch = 15, cex = 1)"},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Geographic mask from longitude and latitude — geogMask","text":"continent NULL string (array strings) specify   continent name(s): one continent, region,    country specified. Valid list continent names   can obtained running geogMask(). region NULL string (array strings) specify   region name(s): one continent, region,   country specified. Valid list region names   can obtained running geogMask(). country NULL string (array strings) specify   country ISO3 character code(s): one continent,   region, country specified. Valid list   country ISO3 character code(s) can obtained running   geogMask(). lon vector longitudes length N. Longitudes takes   values -180 180 (0 360).   gridded data, length may value (n) provided   n * m = N n = length(unique(lon)) m = length(unique(lat)). lat vector latitudes length N m. See lon. InDispute logical: areas dispute considered   geographic masking country? InDispute = TRUE (default),   areas dispute considered part country. verbose logical print processing information verbose = TRUE. plot logical call plotting method plot = TRUE. colPalette color palette list colors generated   rainbow, heat.colors, topo.colors,   terrain.colors similar functions. pch Either integer specifying symbol single character   used default plotting points. See points   possible values. cex numerical value giving amount plotting symbols   magnified relative default = 1.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Geographic mask from longitude and latitude — geogMask","text":"vector indices spatial elements masked,   required HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Geographic mask from longitude and latitude — geogMask","text":"applications, user may want focus area   mask-defined subset full dataset. instance, NASA Tropical   Rainfall Measuring Mission (TRMM) data covers ocean land,   researcher might interested precipitation variability   land, country, list countries (e.g., Nile Basin countries).   masking capability supported geogMask helper function.   requires longitude (lon) latitude (lat) vectors   together string (array strings) specify continent   name(s), region name(s), country ISO3 character code(s) via   either continent, region, country parameters. Valid   values can obtained running geogMask(). World mask data   based HIU Large Scale International Boundaries (LSIB) data   (https://hiu.state.gov/data).","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Geographic mask from longitude and latitude — geogMask","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Geographic mask from longitude and latitude — geogMask","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/geogMask.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Geographic mask from longitude and latitude — geogMask","text":"","code":"require(HiClimR)  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Check the valid options for geographic masking geogMask() #> ---> Checking geographic masking options... #> $continent #> [1] \"Africa\"     \"Americas\"   \"Antarctica\" \"Asia\"       \"Europe\"     #> [6] \"Oceania\"    #>  #> $region #>  [1] \"Antarctica\"                \"Australia and New Zealand\" #>  [3] \"Caribbean\"                 \"Central America\"           #>  [5] \"Central Asia\"              \"Eastern Africa\"            #>  [7] \"Eastern Asia\"              \"Eastern Europe\"            #>  [9] \"Melanesia\"                 \"Micronesia\"                #> [11] \"Middle Africa\"             \"Northern Africa\"           #> [13] \"Northern America \"         \"Northern Europe\"           #> [15] \"Polynesia\"                 \"South America\"             #> [17] \"South-Eastern Asia\"        \"Southern Africa\"           #> [19] \"Southern Asia\"             \"Southern Europe\"           #> [21] \"Western Africa\"            \"Western Asia\"              #> [23] \"Western Europe\"            #>  #> $country #>   [1] \"ABW\" \"AFG\" \"AGO\" \"AIA\" \"ALB\" \"AND\" \"ANT\" \"ARE\" \"ARG\" \"ARM\" \"ASM\" \"ATA\" #>  [13] \"ATF\" \"ATG\" \"AUS\" \"AUT\" \"AZE\" \"BDI\" \"BEL\" \"BEN\" \"BFA\" \"BGD\" \"BGR\" \"BHR\" #>  [25] \"BHS\" \"BIH\" \"BLM\" \"BLR\" \"BLZ\" \"BMU\" \"BOL\" \"BRA\" \"BRB\" \"BRN\" \"BTN\" \"BVT\" #>  [37] \"BWA\" \"CAF\" \"CAN\" \"CCK\" \"CHE\" \"CHL\" \"CHN\" \"CIV\" \"CMR\" \"COD\" \"COG\" \"COK\" #>  [49] \"COL\" \"COM\" \"CPV\" \"CRI\" \"CUB\" \"CUW\" \"CXR\" \"CYM\" \"CYP\" \"CZE\" \"DEU\" \"DJI\" #>  [61] \"DMA\" \"DNK\" \"DOM\" \"DZA\" \"ECU\" \"EGY\" \"ERI\" \"ESH\" \"ESP\" \"EST\" \"ETH\" \"FIN\" #>  [73] \"FJI\" \"FLK\" \"FRA\" \"FRO\" \"FSM\" \"GAB\" \"GBR\" \"GEO\" \"GGY\" \"GHA\" \"GIN\" \"GLP\" #>  [85] \"GMB\" \"GNB\" \"GNQ\" \"GRC\" \"GRD\" \"GRL\" \"GTM\" \"GUF\" \"GUM\" \"GUY\" \"HKG\" \"HMD\" #>  [97] \"HND\" \"HRV\" \"HTI\" \"HUN\" \"IDN\" \"IMN\" \"IND\" \"IOT\" \"IRL\" \"IRN\" \"IRQ\" \"ISL\" #> [109] \"ISR\" \"ITA\" \"JAM\" \"JEY\" \"JOR\" \"JPN\" \"KAZ\" \"KEN\" \"KGZ\" \"KHM\" \"KIR\" \"KNA\" #> [121] \"KOR\" \"KWT\" \"LAO\" \"LBN\" \"LBR\" \"LBY\" \"LCA\" \"LIE\" \"LKA\" \"LSO\" \"LTU\" \"LUX\" #> [133] \"LVA\" \"MAC\" \"MAF\" \"MAR\" \"MCO\" \"MDA\" \"MDG\" \"MDV\" \"MEX\" \"MHL\" \"MKD\" \"MLI\" #> [145] \"MLT\" \"MMR\" \"MNE\" \"MNG\" \"MNP\" \"MOZ\" \"MRT\" \"MSR\" \"MTQ\" \"MUS\" \"MWI\" \"MYS\" #> [157] \"MYT\" \"NAM\" \"NCL\" \"NER\" \"NFK\" \"NGA\" \"NIC\" \"NIU\" \"NLD\" \"NOR\" \"NPL\" \"NRU\" #> [169] \"NZL\" \"OMN\" \"PAK\" \"PAN\" \"PCN\" \"PER\" \"PHL\" \"PLW\" \"PNG\" \"POL\" \"PRI\" \"PRK\" #> [181] \"PRT\" \"PRY\" \"PSE\" \"PYF\" \"QAT\" \"REU\" \"ROU\" \"RUS\" \"RWA\" \"SAU\" \"SDN\" \"SEN\" #> [193] \"SGP\" \"SGS\" \"SHN\" \"SJM\" \"SLB\" \"SLE\" \"SLV\" \"SMR\" \"SOM\" \"SPM\" \"SSD\" \"STP\" #> [205] \"SUR\" \"SVK\" \"SVN\" \"SWE\" \"SWZ\" \"SXM\" \"SYC\" \"SYR\" \"TCA\" \"TCD\" \"TGO\" \"THA\" #> [217] \"TJK\" \"TKL\" \"TKM\" \"TLS\" \"TON\" \"TTO\" \"TUN\" \"TUR\" \"TUV\" \"TWN\" \"TZA\" \"UGA\" #> [229] \"UKR\" \"UMI\" \"URY\" \"USA\" \"UZB\" \"VAT\" \"VCT\" \"VEN\" \"VGB\" \"VIR\" \"VNM\" \"VUT\" #> [241] \"WLF\" \"WSM\" \"YEM\" \"ZAF\" \"ZMB\" \"ZWE\" #>   ## geographic mask for Africa gMask <- geogMask(continent = \"Africa\", lon = lon, lat = lat, plot = TRUE) #> ---> Checking geographic masking options... #> ---> Checking geographic masking data... #> ---> Geographic masking by continent... #> ---> Generating geographic mask map..."},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate longitude and latitude grid matrices — grid2D","title":"Generate longitude and latitude grid matrices — grid2D","text":"grid2D helper function generates longitude latitude   rectangular mesh short longitude latitude vectors gridded data.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate longitude and latitude grid matrices — grid2D","text":"","code":"grid2D(lon = lon, lat = lat)"},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate longitude and latitude grid matrices — grid2D","text":"lon vector longitudes length N. Longitudes takes   values -180 180 (0 360).   gridded data, length may value (n) provided   n * m = N n = length(unique(lon)) m = length(unique(lat)). lat vector latitudes length N m. See lon.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate longitude and latitude grid matrices — grid2D","text":"list following components: lon (n rows m columns) matrix 'double' values   longitude mesh grid, vector length n * m. lat (n rows m columns) matrix 'double' values   latitude mesh grid, vector length n * m.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate longitude and latitude grid matrices — grid2D","text":"grid2D function convert long latitude longitude vectors   rectangular two-dimensional grid visualization geographic masking   purposes gridded data HiClimR package.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Generate longitude and latitude grid matrices — grid2D","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Generate longitude and latitude grid matrices — grid2D","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/grid2D.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate longitude and latitude grid matrices — grid2D","text":"","code":"require(HiClimR)  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)"},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":null,"dir":"Reference","previous_headings":"","what":"Minimum significant correlation for a sample size — minSigCor","title":"Minimum significant correlation for a sample size — minSigCor","text":"minSigCor helper function estimates minimum   significant correlation sample size n confidence level   defined argument alpha.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minimum significant correlation for a sample size — minSigCor","text":"","code":"minSigCor(n = 41, alpha = 0.05, r = seq(0, 1, by = 1e-6))"},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Minimum significant correlation for a sample size — minSigCor","text":"n sample size length timeseries vector. alpha confidence level: default alpha = 0.05   95% confidence level. r vector values 0 1 search   minimum significant correlation user-specified sample size   n confidence level alpha. subset   valid positive correlation range 0-1. default search   minimum significant correlation complete range 0-1   fine step 1e-6. faster computations, user may set shorter   range larger step (e.g., seq(0.1, 0.5, =1e-3)).","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Minimum significant correlation for a sample size — minSigCor","text":"positive value 0 1 estimated minimum   significant correlation.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Minimum significant correlation for a sample size — minSigCor","text":"minSigCor function estimates minimum significant correlation   sample size (number observations temporal points timeseries)   certain confidence level selected argument alpha   optional search range r. called validClimR   function objective tree cut based specified confidence level.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Minimum significant correlation for a sample size — minSigCor","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Minimum significant correlation for a sample size — minSigCor","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/minSigCor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Minimum significant correlation for a sample size — minSigCor","text":"","code":"require(HiClimR)  ## Find minimum significant correlation at 95% confidence level rMin <- minSigCor(n = 41, alpha = 0.05, r = seq(0, 1, by = 1e-06))"},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":null,"dir":"Reference","previous_headings":"","what":"Validation of Hierarchical Climate Regionalization — validClimR","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"validClimR computes indices cluster validation,   objective tree cut regional linkage clustering method.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"","code":"validClimR(y = NULL, k = NULL, minSize = 1, alpha = 0.05, verbose = TRUE,     plot = FALSE, colPalette = NULL, pch = 15, cex = 1)"},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"y dendrogram tree produced HiClimR. k NULL n integer k > 1 number regions/clusters.   regional linkage method, k = NULL supported,   \"optimal\" number regions used user specified significance   level alpha. required specify number clusters k   methods, since based inter-cluster correlation.   k = NULL methods (except regional) linkage,   validClimR aborted. One can use validClimR function   compute inter-cluster correlation different number clusters objectively   cut tree methods, computationally expensive   cover entire merging history large number spatial elements. minSize minimum cluster size. regional linkage method tend   isolate noisy data small clusters. minSize can used   exclude small clusters statSum statistical   summary, likely noisy data need checked   quality control step. analysis may repeated. alpha confidence level: default alpha = 0.05   95% confidence level. verbose logical print processing information verbose = TRUE. plot logical call plotting method plot = TRUE. colPalette color palette list colors generated   rainbow, heat.colors, topo.colors,   terrain.colors similar functions. pch Either integer specifying symbol single character   used default plotting points. See points   possible values. cex numerical value giving amount plotting symbols   magnified relative default = 1.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"object class HiClimR produces indices validating   tree produced clustering process.   object list following components: cutLevel minimum significant correlation used objective     tree cut together corresponding confidence level. clustMean cluster means region's mean timeseries     selected regions. clustSize cluster sizes selected regions. clustFlag flag 0 1 indicate cluster used     statSum validation indices (interCor,     intraCor, diffCor, statSum), based     minSize minimum cluster size.     clustFlag = 0, cluster excluded size     less minSize minimum cluster size. sum     clustFlag elements represents selected number clusters. interCor inter-cluster correlations selected regions.     inter-cluster correlations cluster means. maximum inter-cluster     correlation measure separation contiguity,     used objective tree cut (find \"optimal\" number clusters). intraCor intra-cluster correlations selected regions.     intra-cluster correlations mean cluster     members. average intra-cluster correlation weighted average     clusters, measure homogeneity. diffCor difference intra-cluster correlation maximum   \tinter-cluster correlation selected regions. statSum overall statistical summary interCluster,     intraCor, diffCor. region ordered regions vector size N number spatial   \telements selected number clusters, excluding   \tsmall clusters defined minSize argument. regionID ordered regions ID vector length equals selected number   \tclusters, excluding small clusters defined minSize argument.   \thelps mapping ordered regions actual names ordering.   \tregion component uses ordered ID, components use   \tnames used clustering process.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"validClimR function used validation dendrogram tree   produced HiClimR, computing  detailed statistical information   cluster cluster means, sizes, intra- inter-cluster correlations,   overall summary. requires preprocessed data matrix tree   HiClimR function inputs. optional parameter can used   validate clustering selected number clusters k. k = NULL,   default supports regional linkage method, objective cutting   tree find optimal number clusters applied based user   specified significance level (alpha parameter). regional linkage method,   noisy spatial elements isolated small-size clusters individuals since   correlate well elements. can excluded   validation indices (interCor, intraCor, diffCor, statSum),   based minSize minimum cluster size. excluded clusters identified   output validClimR clustFlag, takes value 1   selected clusters 0 excluded clusters. sum clustFlag   elements represents selected number clusters.followed quality   control step repeating analysis.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2015):   Tool Hierarchical Climate Regionalization, Earth Science Informatics,   8(4), 949-958, doi: 10.1007/s12145-015-0221-7 . Hamada S. Badr, Zaitchik, B. F. Dezfuli, . K. (2014):   Hierarchical Climate Regionalization,   Comprehensive R Archive Network (CRAN),   https://cran.r-project.org/package=HiClimR.","code":""},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"Hamada S. Badr <badr@jhu.edu>, Benjamin F. Zaitchik <zaitchik@jhu.edu>,   Amin K. Dezfuli <amin.dezfuli@nasa.gov>. HiClimR   modification hclust function, based   Fortran code contributed STATLIB F. Murtagh.","code":""},{"path":[]},{"path":"https://hsbadr.github.io/HiClimR/reference/validClimR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validation of Hierarchical Climate Regionalization — validClimR","text":"","code":"require(HiClimR)  ## Load test case data x <- TestCase$x  ## Generate longitude and latitude mesh vectors xGrid <- grid2D(lon = unique(TestCase$lon), lat = unique(TestCase$lat)) lon <- c(xGrid$lon) lat <- c(xGrid$lat)  ## Hierarchical Climate Regionalization y <- HiClimR(x, lon = lon, lat = lat, lonStep = 1, latStep = 1, geogMask = FALSE,     continent = \"Africa\", meanThresh = 10, varThresh = 0, detrend = TRUE,     standardize = TRUE, nPC = NULL, method = \"ward\", hybrid = FALSE,     kH = NULL, members = NULL, validClimR = TRUE, k = 12, minSize = 1,     alpha = 0.01, plot = TRUE, colPalette = NULL, hang = -1, labels = FALSE) #>  #> PROCESSING STARTED #>  #> Checking Multivariate Clustering (MVC)... #> ---> x is a matrix #> ---> single-variate clustering: 1 variable #> Checking data... #> ---> Checking dimensions... #> ---> Checking row names... #> ---> Checking column names... #> Data filtering... #> ---> Computing mean for each row... #> ---> Checking rows with mean bellow meanThresh... #> ---> 4678 rows found, mean ≤  10 #> ---> Computing variance for each row... #> ---> Checking rows with near-zero-variance... #> ---> 3951 rows found, variance ≤  0 #> Data preprocessing... #> ---> Applying mask... #> ---> Checking columns with missing values... #> ---> Removing linear trend... #> ---> Standardizing data... #> Agglomerative Hierarchical Clustering... #> ---> Computing correlation/dissimilarity matrix... #> ---> Starting clustering process... #> ---> Constructing dendrogram tree... #> Calling cluster validation... #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map... #>  #> PROCESSING COMPLETED #>  #> Running Time: #>    user  system elapsed  #>   0.380   0.052   0.432  #> Time difference of 0.4322302 secs  ## Validtion of Hierarchical Climate Regionalization z <- validClimR(y, k = 12, minSize = 1, alpha = 0.01, plot = TRUE) #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map...  ## Use a specified number of clusters (k = 12) z <- validClimR(y, k = 12, minSize = 1, alpha = 0.01, plot = TRUE) #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map...  ## Apply minimum cluster size (minSize = 25) z <- validClimR(y, k = 12, minSize = 25, alpha = 0.01, plot = TRUE) #> ---> Computing cluster means... #> ---> Computing inter-cluster correlations... #> ---> Computing intra-cluster correlations... #> ---> Computing summary statistics... #> Generating region map...  ## The optimal number of clusters, including small clusters k <- length(z$clustFlag)  ## The selected number of clusters, after excluding small clusters (if minSize > 1) ks <- sum(z$clustFlag)"}]
